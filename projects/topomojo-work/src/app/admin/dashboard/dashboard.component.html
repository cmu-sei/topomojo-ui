<!-- Copyright 2021 Carnegie Mellon University. -->
<!-- Released under a 3 Clause BSD-style license. See LICENSE.md in the project root. -->

<div class="mb-3">
  <div class="text-muted">
    Admin tools for monitoring active users, broadcasting announcements, and viewing Janitor cleanup activity.
  </div>
</div>

<h4>Hub Connections</h4>
<div class="text-muted mb-2">
  Users currently connected to TopoMojo.
</div>
<div *ngFor="let c of connections | async; trackBy:trackById" class="mx-4 my-1">{{c.profileName}}</div>

<h4 class="mt-3">Announcement</h4>
<div class="text-muted mb-2">
  Broadcast an important message to everyone in TopoMojo. Announcements appear in the TopoMojo interface.
</div>

<div class="form-group bg-light">
  <label class="mb-0 d-flex align-items-center" for="announcement-input">
    Message
    <span
      class="ml-2 text-muted"
      role="button"
      tabindex="0"
      [tooltip]="'Enter the content of the announcement. This will be shown to all users in the TopoMojo interface.'"
      placement="right"
      container="body"
      triggers="hover focus"
      aria-label="Enter the content of the announcement. This will be shown to all users in the TopoMojo interface."
    >
      <fa-icon [icon]="faInfoCircle"></fa-icon>
    </span>
  </label>

  <textarea
    id="announcement-input"
    class="form-control"
    placeholder="Message"
    rows="3"
    [(ngModel)]="announcement"
  ></textarea>

  <small class="text-muted d-block mb-2">
    Use this for time-sensitive updates (maintenance, outages, deadlines, or competition announcements).
  </small>

  <button
    class="btn btn-secondary btn-sm"
    (click)="announce()"
    placement="right"
    [tooltip]="'Send this announcement to all users.'"
    container="body"
    triggers="hover focus"
    aria-label="Send this announcement to all users."
  >
    <fa-icon [icon]="faSend"></fa-icon>
    <span>Send</span>
  </button>
</div>

<h4 class="mt-3">Janitor</h4>
<div class="text-muted mb-2">
  The Janitor service cleans up unused resources (for example, workspaces or VMs that have been idle for a long time).
</div>

<div class="input mb-2">
  <button
    class="btn btn-secondary"
    (click)="cleanup()"
    placement="right"
    [tooltip]="'Generate a report of recent Janitor cleanup activity.'"
    container="body"
    triggers="hover focus"
    aria-label="Generate a report of recent Janitor cleanup activity."
  >
    Cleanup Report
  </button>
</div>

<p *ngFor="let r of janitorResult | async" class="mb-1">
  <span>{{r.reason}}</span>,
  <span>{{r.name}}</span>,
  <span>{{r.age}}</span>
</p>
