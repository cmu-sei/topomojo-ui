<!-- Copyright 2021 Carnegie Mellon University. -->
<!-- Released under a 3 Clause BSD-style license. See LICENSE.md in the project root. -->

<!-- search workspaces -->
<div class="m-2">

  <!-- input -->
  <div class="input-group mb-0">
    <div class="input-group-prepend">
      <!-- <label for="search-input" class="input-group-text">Search</label> -->
      <span id="search-label" class="input-group-text">Search</span>
    </div>
    <input #searchterm id="search-input" type="search" [placeholder]="mode" class="form-control" [(ngModel)]="search.term" (input)="termed($event)" aria-label="search term" aria-describedby="search-label">
  </div>

  <!-- filters -->
  <div class="mb-2">
    <button
      class="mr-1 btn btn-link text-secondary btn-sm d-inline-flex align-items-center"
      (click)="setMode('workspace')"
    >
      <fa-icon [hidden]="mode!=='workspace'" [icon]="faFilter"></fa-icon>
      <span class="ml-1">workspace</span>

      <!-- info icon (hover for tooltip) -->
      <fa-icon
        class="ml-2 info-icon"
        [icon]="faInfoCircle"
        title="Workspaces you can access (active, invited to, or permitted). Build and manage lab content here."
        aria-label="Info: Workspaces you can access (active, invited to, or permitted). Build and manage lab content here."
        (click)="$event.stopPropagation()"
      ></fa-icon>
    </button>

    <button
      class="mr-1 btn btn-link text-secondary btn-sm d-inline-flex align-items-center"
      (click)="setMode('gamespace')"
    >
      <fa-icon [hidden]="mode!=='gamespace'" [icon]="faFilter"></fa-icon>
      <span class="ml-1">gamespace</span>

      <!-- info icon (hover for tooltip) -->
      <fa-icon
        class="ml-2 info-icon"
        [icon]="faInfoCircle"
        title="Gamespaces you can play. Read-only copies of workspaces you can launch or join to complete labs."
        aria-label="Info: Gamespaces you can play. Read-only copies of workspaces you can launch or join to complete labs."
        (click)="$event.stopPropagation()"
      ></fa-icon>
    </button>

    <button
      class="mr-1 btn btn-link text-secondary btn-sm d-inline-flex align-items-center"
      (click)="refresh()"
    >
      <fa-icon [icon]="faSync"></fa-icon>
      <span class="ml-1">refresh</span>
    </button>
  </div>

  <app-pager [skip]="skip" [take]="take" [count]="count" (changed)="paged($event)"></app-pager>
  <hr class="mt-0 mb-2"/>

  <!-- display workspace cards -->
  <ng-container *ngIf="mode === 'workspace'">
    <ng-container *ngFor="let ws of workspaces | async">
      <app-workspace-card
        [workspace]="ws"
        [isFavorite]="isFavorite(ws.id)"
        (favoriteToggle)="toggleFavorite(ws.id)">
      </app-workspace-card>
    </ng-container>
  </ng-container>

  <!-- display gamespace cards -->
  <ng-container *ngIf="mode === 'gamespace'">
    <ng-container *ngFor="let g of gamespaces | async">
      <app-gamespace-card
        [gamespace]="g"
        [canFavorite]="isPlayableGamespace(g)"
        [isFavorite]="isPlayableGamespace(g) && isFavorite(g.id)"
        (favoriteToggle)="toggleGamespaceFavorite(g)">
      </app-gamespace-card>
    </ng-container>
  </ng-container>


  <hr class="my-0"/>
  <app-pager [skip]="skip" [take]="take" [count]="count" (changed)="paged($event)"></app-pager>

</div>

<ng-template #loading>
  <app-spinner></app-spinner>
</ng-template>
