<!-- Copyright 2021 Carnegie Mellon University. -->
<!-- Released under a 3 Clause BSD-style license. See LICENSE.md in the project root. -->

<alert type="warning" [dismissible]="true" dismissOnTimeout="10000">
  Inactive workspaces may be deleted by the janitor.<br/>
  <small>Inactive: "unpublished and idle" or "published and unused"</small>
</alert>

<div class="workspace-stats border rounded p-2 mb-3">
  <div class="d-flex flex-wrap align-items-center">
    <span class="mr-3 text-muted">
      <span>Launch Count:</span>
     {{ workspace.stats.launchCount }}
    </span>

    <span class="mr-3 text-muted">
      <span>Last Activity:</span>
      {{ workspace.stats.lastActivity }}
    </span>
  </div>
</div>

<div>
  <div class="text-muted">
    Use this tab to manage the workspace metadata: how it's labeled, described, who it's attributed to, who can
    launch it, and how long it's expected to take.
  </div>
</div>

<form [formGroup]="form">

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="name-input">
      Title
    </label>
    <input id="name-input" type="text" class="form-control" formControlName="name">
    <small>
      The name shown when browsing workspaces. Keep it unique and descriptive (e.g., “Web Exploits Lab 1”).
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="description-input">
      Description
    </label>
    <textarea id="description-input" type="text" rows="3" class="form-control" formControlName="description"></textarea>
    <small>
      What this lab is about. This text appears in workspace browsing and may be visible broadly.
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="tags-input">
      Tags
    </label>
    <input id="tags-input" type="text" class="form-control" formControlName="tags">
    <small>
      Internal labels to help organize and search (e.g., “competition”, “web”, “c01”). Space-delimited.
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="author-input">
      Authorship
    </label>
    <input id="author-input" type="text" class="form-control" formControlName="author">
    <small>
      Credit the lab creators and contributors (shown as the workspace author text).
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="audience-input">
      Audience
    </label>
    <input id="audience-input" type="text" class="form-control" formControlName="audience">
    <small>
      Who can launch/play this as a gamespace. Enter one or more groups (space-delimited). Use
      '<code>everyone</code>' to allow all users.
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center" for="durationMinutes-input">
      Duration
    </label>
    <input id="durationMinutes-input" type="number" class="form-control" formControlName="durationMinutes">
    <small>
      Estimated time (minutes) to complete the lab. This helps set expectations for players.
    </small>
  </div>

  <div class="form-group bg-light">
    <label class="mb-0 d-flex align-items-center">
      Collaboration
    </label>

    <div *ngIf="!workspace.workers?.length">&mdash; none</div>

    <div *ngFor="let worker of workspace.workers">
      <app-confirm-button class="mr-2" btnClass="btn btn-outline-danger btn-sm" (confirm)="delist(worker)" aria-label="remove collaborator">
        <fa-icon [icon]="faTimes"></fa-icon>
        <span>Remove</span>
      </app-confirm-button>
      <span>{{worker.subjectName}}</span>
    </div>

    <div class="mt-2">
      <button class="btn btn-outline-secondary" (click)="enlistCode()">
        <fa-icon [icon]="copiedInvite ? faClipboardCheck : faUserCog"></fa-icon>
        <span>Generate invitation</span>
      </button>
    </div>
    <small>
      Share an invitation link to add collaborators. Generating a new link invalidates the previous one.
    </small>

  </div>

  <hr/>
  <app-error-div [errors]="errors"></app-error-div>
  <div class="text-center mb-4">

    <app-confirm-button btnClass="btn btn-outline-secondary btn-lg" (confirm)="clone()">
      <fa-icon [icon]="faCopy"></fa-icon>
      <span>Clone</span>
    </app-confirm-button>

    <span class="m-2"></span>

    <app-confirm-button btnClass="btn btn-outline-danger btn-lg" (confirm)="delete()">
      <fa-icon [icon]="faTrash"></fa-icon>
      <span>Delete</span>
    </app-confirm-button>

  </div>
</form>
